#!/bin/sh
# pre-commit hook
# Orchestrates validation and update scripts

SCRIPT_DIR="$(cd "$(dirname "$0")/.." && pwd)"

# Step 1: Validate taxonomy terms
echo "==================================="
echo "Step 1: Validating taxonomy terms"
echo "==================================="

if ! "$SCRIPT_DIR/validate-taxonomy-terms.sh"; then
    echo ""
    echo "ERROR: Taxonomy term validation failed."
    echo "Commit aborted. Please fix the errors above before committing."
    exit 1
fi

echo ""

# Step 2: Update edit time
echo "==================================="
echo "Step 2: Updating edit time"
echo "==================================="

if ! "$SCRIPT_DIR/update-edit-time.sh"; then
    echo ""
    echo "ERROR: Edit time update failed."
    echo "Commit aborted."
    exit 1
fi

echo ""
echo "==================================="
echo "Pre-commit checks completed successfully!"
echo "==================================="

exit 0
